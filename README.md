# PARuS (Polymorphism Analysis of Russian SARS-Cov-2)

**Основная задача** — поиск в исследуемой последовательности по референсу, а так же выделение её принадлежности к определённой группе мутаций (в данном случае британская).

**Входные данные** — путь к `.fasta` или `.fa` файлу с исследуемыми последовательностями.

**Результат** — в зависимости от переданного ключа `-table` : либо `.json` файл у которого два ключа `raw_all_table` и 
`raw_report_table`, возвращают `.csv` с результатами работы скрипта (в форме строки), остальные ключи соответствуют 
названию последовательности в файле и возвращают словарь копирующий таблицу `raw_report_table`. Если ключ `-table` передан,
то вместо `json` возвращается несколько (при данном количестве геновариантов двенадцать) `.csv` файлов с мутациями, один с полным списком 
мутаций, один со сводной талицей по каждому образцу и отметками о наличии конкретных мутаций из списка (определяющих каждую группу) и отметкой о принадлежности образца к искомому штамму (если найдено несколько групп мутаций то ставится отметка о принадлежности к нескольким группам одновременно), остальные файлы представляют собой аналог сводной таблицы, но по каждому геноварианту отдельно.

## Quick start

Расчёты реализованы как скрипт, основной файл `ORO.py`, для его работы необходимы следующие программы и библиотеки:

- `BLAST` — скрипт для выравнивания последовательностей.

- `os, uuid, argparse, tempfile` — встроенные библиотеки, необходимые для работы с файлами и для создания входных параметров.

- `pandas` — библиотека для работы с таблицами.

- `json` — библиотека для взаимодействия с файлами `.json`.

- `inspect` — дополнительная библиотека для работы с файловой системой.


Скрипт имеет следующие входные параметры:

- `data` — папка с данными для анализа (анализироваться будут только `.fasta` или `.fa` файлы). **Обязательный параметр**.

- `-result`(`--result`) — название файлов с результатами **Необязательный параметр** (по умолчанию будет присваиваться название `result`).

- `-no_code`(`--no_code`) — флаг отвечающий за кодировку `True` - `'cp1251'`, `False` - `'UTF-8'` **Необязательный параметр**(по умолчанию `False`) 

- `-one_sample`(`--one_sample`) — флаг отвечающий за поведение скрипта, зависит от типа данных которые подаются, по умолчанию `False` 
  и скрипт нацелен на работу с полными геномами **, но** если он передан, то скрипт корректно обрабатывает фрагменты 
  генома **, по одному файлу** за раз, подача нескольких файлов приведёт к ошибке **Необязательный параметр** 

- `-table`(`--table`) — флаг отвечающий за изменение вывода скрипта и появление дополнительного `.json` файла, 
  вместо полного списка таблиц, необходимого для дальнейшей автоматической обработки **Необязательный параметр** 

  


## Структура репозитория

```angular2html
│   ORO.py            — главный исполняемый файл
│   README.md
│   class_seq.py      — файл с внутренними функциями 
│   
├───data              — основные классы, используемые в проекте
│   ├───ref_seq.fasta       — референсная последовательность
│   ├───ref_seq.fasta.ndb   — сопутствующие файлы для выравнивания
│   ├───ref_seq.fasta.nhr   — сопутствующие файлы для выравнивания
│   ├───ref_seq.fasta.nin   — сопутствующие файлы для выравнивания
│   ├───ref_seq.fasta.not   — сопутствующие файлы для выравнивания
│   ├───ref_seq.fasta.nsq   — сопутствующие файлы для выравнивания
│   ├───ref_seq.fasta.ntf   — сопутствующие файлы для выравнивания
│   ├───ref_seq.fasta.nto   — сопутствующие файлы для выравнивания
│   ├───cord_cov.json       — данные о границах кодирующих областей
│   └───config.json         — конфигурационные данные
│   
└───clade             — основные классы, используемые в проекте
    ├───Alpha_list.json     — список мутаций геноварианта Alpha
    ├───Beta_list.json      — список мутаций геноварианта Beta
    ├───Gamma_list.json     — список мутаций геноварианта Gamma
    ├───AT_1_list.json      — список мутаций геноварианта AT_1
    ├───Eta_list.json       — список мутаций геноварианта Eta
    ├───Iota_list.json      — список мутаций геноварианта Iota
    ├───Lambda_list.json    — список мутаций геноварианта Lambda
    ├───Kappa_list.json     — список мутаций геноварианта Kappa
    ├───msk_list.json       — список мутаций геноварианта B.1.1.523
    └───Delta_list.json     — список мутаций геноварианта Delta 

